import numpy
from .explicit_runge_kutta import RungeKutta


class ExLRK43(RungeKutta):
    # effective number of stages
    n_stages = 4

    # order of the main method
    order = 4

    # order of the secondary embedded method
    error_estimator_order = 3  # for linear

    # time fraction coefficients (nodes)
    C = numpy.array([0, 0.5, 0.5, 1])

    # runge kutta coefficient matrix
    A = numpy.array(
        [
            [0.0, 0.0, 0.0, 0.0],
            [0.5, 0.0, 0.0, 0.0],
            [0.0, 0.5, 0.0, 0.0],
            [0.0, 0.0, 1.0, 0.0],
        ]
    )

    # output coefficients (weights)
    B = numpy.array([1.0 / 6.0, 1.0 / 3.0, 1.0 / 3.0, 1.0 / 6.0])

    # error coefficients (weights Bh - B)
    E = numpy.array([1.0 / 6.0, 1.0 / 3.0, 1.0 / 3.0, 41.0 / 300.0, 3.0 / 100.0])
    E[:-1] -= B


class ExLRK32(RungeKutta):
    # effective number of stages
    n_stages = 3

    # order of the main method
    order = 3

    # order of the secondary embedded method
    error_estimator_order = 2  # for both linear and non-linear

    # time fraction coefficients (nodes)
    C = numpy.array([0.0, 1.0 / 2.0, 1.0])

    # runge kutta coefficient matrix
    A = numpy.array([[0.0, 0.0, 0.0], [1 / 2, 0.0, 0.0], [-1.0, 2.0, 0.0]])

    # output coefficients (weights)
    B = numpy.array([1.0 / 6.0, 2.0 / 3.0, 1.0 / 6.0])

    # error coefficients (weights Bh - B)
    E = numpy.array([0.25, 0.5, 0.1, 0.15])  # B_hat
    E[:-1] -= B


class KC32(RungeKutta):
    # From Kennedy and Carpenter 2003, ARK3_2_4L_2_SA_ERK
    # effective number of stages
    n_stages = 4

    # order of the main method
    order = 3

    # order of the secondary embedded method
    error_estimator_order = 2

    # time fraction coefficients (nodes)
    C = numpy.array([0.0, 1767732205903 / 2027836641118, 3 / 5, 1])

    # runge kutta coefficient matrix
    A = numpy.array(
        [
            [0.0, 0.0, 0.0, 0.0],
            [1767732205903 / 2027836641118, 0.0, 0.0, 0.0],
            [5535828885825 / 10492691773637, 788022342437 / 10882634858940, 0.0, 0.0],
            [
                6485989280629 / 16251701735622,
                -4246266847089 / 9704473918619,
                10755448449292 / 10357097424841,
                0.0,
            ],
        ]
    )

    # output coefficients (weights)
    B = numpy.array(
        [
            1471266399579 / 7840856788654,
            -4482444167858 / 7529755066697,
            11266239266428 / 11593286722821,
            1767732205903 / 4055673282236,
        ]
    )

    # error coefficients (weights Bh - B)
    E = numpy.array([0.02709926, 0.11013521, -0.10306493, -0.03416955, 0])


class M43(RungeKutta):

    # effective number of stages
    n_stages = 5

    # order of the main method for linear problem
    order = 4  # order 5 for linear homogenous system

    # order of the secondary embedded method
    error_estimator_order = 3

    # time fraction coefficients (nodes)
    C = numpy.array([0, 1 / 3, 1 / 3, 1 / 2, 1])

    # runge kutta coefficient matrix
    A = numpy.array(
        [
            [0, 0, 0, 0, 0],
            [1 / 3, 0, 0, 0, 0],
            [1 / 6, 1 / 6, 0, 0, 0],
            [1 / 8, 0, 3 / 8, 0, 0],
            [1 / 2, 0, -3 / 2, 2, 0],
        ]
    )

    # output coefficients (weights)
    B = numpy.array([1 / 6, 0, 0, 2 / 3, 1 / 6])

    # error coefficients (weights Bh - B)
    E = numpy.array([1 / 10, 0, 3 / 10, 2 / 5, 1 / 5, 0])  # B_hat
    E[:-1] -= B


class BS32(RungeKutta):

    order = 3
    error_estimator_order = 2
    n_stages = 3
    C = numpy.array([0, 1 / 2, 3 / 4])
    A = numpy.array([[0, 0, 0], [1 / 2, 0, 0], [0, 3 / 4, 0]])
    B = numpy.array([2 / 9, 1 / 3, 4 / 9])
    E = numpy.array([5 / 72, -1 / 12, -1 / 9, 1 / 8])


class DP54(RungeKutta):
    order = 5
    error_estimator_order = 4
    n_stages = 6
    C = numpy.array([0, 1 / 5, 3 / 10, 4 / 5, 8 / 9, 1])
    A = numpy.array(
        [
            [0, 0, 0, 0, 0],
            [1 / 5, 0, 0, 0, 0],
            [3 / 40, 9 / 40, 0, 0, 0],
            [44 / 45, -56 / 15, 32 / 9, 0, 0],
            [19372 / 6561, -25360 / 2187, 64448 / 6561, -212 / 729, 0],
            [9017 / 3168, -355 / 33, 46732 / 5247, 49 / 176, -5103 / 18656],
        ]
    )
    B = numpy.array([35 / 384, 0, 500 / 1113, 125 / 192, -2187 / 6784, 11 / 84])
    E = numpy.array([-71 / 57600, 0, 71 / 16695, -71 / 1920, 17253 / 339200, -22 / 525, 1 / 40])


class F14_12(
    RungeKutta
):  # Feagin 14/12 method RK1412 in https://github.com/Microno95/desolver/blob/be9c3014c026b8566c9bfa3d37c021736a4a7f99/desolver/integrators/explicit_integration_schemes.py
    order = 14
    error_estimator_order = 12
    n_stages = 35
    tableau = numpy.array(
        [
            [
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
            ],
            [
                11111111111111111.0 / 100000000000000000.0,
                11111111111111111.0 / 100000000000000000.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
            ],
            [
                13888888888888889.0 / 25000000000000000.0,
                -83333333333333333.0 / 100000000000000000.0,
                138888888888888889.0 / 100000000000000000.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
            ],
            [
                83333333333333333.0 / 100000000000000000.0,
                20833333333333333.0 / 100000000000000000.0,
                0.0,
                5.0 / 8.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
            ],
            [
                33333333333333333.0 / 100000000000000000.0,
                19333333333333333.0 / 100000000000000000.0,
                0.0,
                11.0 / 50.0,
                -2.0 / 25.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
            ],
            [
                1.0 / 1.0,
                1.0 / 10.0,
                0.0,
                0.0,
                2.0 / 5.0,
                1.0 / 2.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
            ],
            [
                16749674481819323.0 / 25000000000000000.0,
                5174228081833989.0 / 50000000000000000.0,
                0.0,
                0.0,
                6103444365320361.0 / 50000000000000000.0,
                24128724516562331.0 / 50000000000000000.0,
                -381409600015607.0 / 10000000000000000.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
            ],
            [
                7426709605345459.0 / 25000000000000000.0,
                12438052665409441.0 / 100000000000000000.0,
                0.0,
                0.0,
                0.0,
                2261202821975843.0 / 10000000000000000.0,
                1378858876180809.0 / 100000000000000000.0,
                -1680525334991711.0 / 25000000000000000.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
            ],
            [
                72727272727272727.0 / 100000000000000000.0,
                4684595328298369.0 / 50000000000000000.0,
                0.0,
                0.0,
                0.0,
                0.0,
                -613406843450511.0 / 100000000000000000.0,
                10800991281275153.0 / 50000000000000000.0,
                21184753175788097.0 / 50000000000000000.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
            ],
            [
                14015279904218877.0 / 100000000000000000.0,
                8384798124090527.0 / 100000000000000000.0,
                0.0,
                0.0,
                0.0,
                0.0,
                -589746835504869.0 / 50000000000000000.0,
                -4945980411376253.0 / 20000000000000000.0,
                978080858367729.0 / 10000000000000000.0,
                21759068924342063.0 / 100000000000000000.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
            ],
            [
                35035051988507537.0 / 50000000000000000.0,
                3076276798847141.0 / 50000000000000000.0,
                0.0,
                0.0,
                0.0,
                0.0,
                592232780324503.0 / 100000000000000000.0,
                47032615996384111.0 / 100000000000000000.0,
                299688863848679.0 / 1000000000000000.0,
                -24765687759399491.0 / 100000000000000000.0,
                1386187872142971.0 / 12500000000000000.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
            ],
            [
                9090909090909091.0 / 25000000000000000.0,
                2098500366813913.0 / 50000000000000000.0,
                0.0,
                0.0,
                0.0,
                0.0,
                -63597539253241.0 / 20000000000000000.0,
                10079971436327401.0 / 12500000000000000.0,
                975983126412389.0 / 10000000000000000.0,
                77857557815839891.0 / 100000000000000000.0,
                20489042383159943.0 / 100000000000000000.0,
                -39065394906867047.0 / 25000000000000000.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
            ],
            [
                26315789473684211.0 / 100000000000000000.0,
                2188633911168651.0 / 50000000000000000.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                124873005504039.0 / 20000000000000000.0,
                20004309710957731.0 / 100000000000000000.0,
                -805328367804983.0 / 100000000000000000.0,
                423035056134793.0 / 20000000000000000.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
            ],
            [
                3921722466502709.0 / 100000000000000000.0,
                1417496251817573.0 / 50000000000000000.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                249163204855817.0 / 100000000000000000.0,
                2301387878545931.0 / 100000000000000000.0,
                -322155956692977.0 / 100000000000000000.0,
                197688509889533.0 / 20000000000000000.0,
                -1065053856644437.0 / 50000000000000000.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
            ],
            [
                20322937573209419.0 / 25000000000000000.0,
                343511894290243.0 / 1000000000000000.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                21045191202362739.0 / 100000000000000000.0,
                25856863014307603.0 / 25000000000000000.0,
                300151822932211.0 / 50000000000000000.0,
                42796906254980977.0 / 50000000000000000.0,
                -97723500503676681.0 / 100000000000000000.0,
                -66002698047929469.0 / 100000000000000000.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
            ],
            [
                16666666666666667.0 / 100000000000000000.0,
                -1435740016721681.0 / 100000000000000000.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                -4578165875613.0 / 125000000000000.0,
                3502549756362137.0 / 100000000000000000.0,
                721892032724227.0 / 20000000000000000.0,
                -2652199675536811.0 / 100000000000000000.0,
                4456990113056981.0 / 100000000000000000.0,
                777144333320989.0 / 6250000000000000.0,
                413829693239481.0 / 100000000000000000.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
            ],
            [
                9.0 / 10.0,
                35603240442512029.0 / 100000000000000000.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                -2250963794737813.0 / 5000000000000000.0,
                4305279070837109.0 / 10000000000000000.0,
                3199831431318889.0 / 6250000000000000.0,
                45415181944320213.0 / 50000000000000000.0,
                -30980273342983483.0 / 25000000000000000.0,
                -64904866167176147.0 / 100000000000000000.0,
                25170890458681929.0 / 100000000000000000.0,
                974883087931983.0 / 1250000000000000.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
            ],
            [
                6412992574519669.0 / 100000000000000000.0,
                1309356874065131.0 / 100000000000000000.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                -9320530679851.0 / 100000000000000000.0,
                2526871671311497.0 / 50000000000000000.0,
                40223517097.0 / 50000000000000000.0,
                59172602949417.0 / 100000000000000000.0,
                -8032294443.0 / 20000000000000000.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
            ],
            [
                4082998185668577.0 / 20000000000000000.0,
                207926484466053.0 / 10000000000000000.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                58269591880009.0 / 100000000000000000.0,
                -25053147886213.0 / 3125000000000000.0,
                403847643847.0 / 100000000000000000.0,
                8546099980555061.0 / 100000000000000000.0,
                -25560810117.0 / 12500000000000000.0,
                10532857882443189.0 / 100000000000000000.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
            ],
            [
                39535039104876057.0 / 100000000000000000.0,
                140153449795736021.0 / 100000000000000000.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                -11512600049211063.0 / 50000000000000000.0,
                -360553420233456453.0 / 50000000000000000.0,
                93225390173709.0 / 25000000000000000.0,
                -471415495727125021.0 / 100000000000000000.0,
                -176367657545349.0 / 100000000000000000.0,
                382065274019349383.0 / 50000000000000000.0,
                70120408731950367.0 / 20000000000000000.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
            ],
            [
                60464960895123943.0 / 100000000000000000.0,
                298786626735301717.0 / 25000000000000000.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                779480932108175969.0 / 100000000000000000.0,
                -225800557546930317.0 / 4000000000000000.0,
                9123763069306449.0 / 100000000000000000.0,
                -636681399627174431.0 / 50000000000000000.0,
                -3968959219047197.0 / 100000000000000000.0,
                544392141883570887.0 / 10000000000000000.0,
                -364411637921569237.0 / 100000000000000000.0,
                -80450324991050991.0 / 100000000000000000.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
            ],
            [
                15917001814331423.0 / 20000000000000000.0,
                -14880942650710048843.0 / 100000000000000000.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                -2293238195728141211.0 / 25000000000000000.0,
                70765614497159835983.0 / 100000000000000000.0,
                -110563611857482441.0 / 100000000000000000.0,
                17613459188381137259.0 / 100000000000000000.0,
                24569241210744033.0 / 50000000000000000.0,
                -17106950011245373609.0 / 25000000000000000.0,
                279910604998398259.0 / 10000000000000000.0,
                659698550151411667.0 / 50000000000000000.0,
                25025756256796089.0 / 20000000000000000.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
            ],
            [
                93587007425480331.0 / 100000000000000000.0,
                -241826986737049191.0 / 25000000000000000.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                -446990150858505531.0 / 100000000000000000.0,
                227563564345476341.0 / 5000000000000000.0,
                -7130850861838269.0 / 100000000000000000.0,
                140342017585515927.0 / 12500000000000000.0,
                394513677242571.0 / 3125000000000000.0,
                -272149587218427071.0 / 6250000000000000.0,
                39358715377152949.0 / 50000000000000000.0,
                26613234837234211.0 / 50000000000000000.0,
                42242273399632533.0 / 100000000000000000.0,
                8591312495030671.0 / 100000000000000000.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
            ],
            [
                16666666666666667.0 / 100000000000000000.0,
                -62915020279409189.0 / 6250000000000000.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                -4578165875613.0 / 125000000000000.0,
                3502549756362137.0 / 100000000000000000.0,
                721892032724227.0 / 20000000000000000.0,
                -2652199675536811.0 / 100000000000000000.0,
                -39193060761341509.0 / 6250000000000000.0,
                4820792374425629891.0 / 100000000000000000.0,
                -868089611420207.0 / 12500000000000000.0,
                1268106902048502957.0 / 100000000000000000.0,
                598355844841619.0 / 50000000000000000.0,
                -58406220624060301.0 / 1250000000000000.0,
                133029613326626711.0 / 100000000000000000.0,
                50383393751699149.0 / 50000000000000000.0,
                2095120519336651.0 / 100000000000000000.0,
                1050673531656321.0 / 50000000000000000.0,
                476098007208561.0 / 50000000000000000.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
            ],
            [
                20322937573209419.0 / 25000000000000000.0,
                -40947808167774370877.0 / 100000000000000000.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                21045191202362739.0 / 100000000000000000.0,
                25856863014307603.0 / 25000000000000000.0,
                300151822932211.0 / 50000000000000000.0,
                42796906254980977.0 / 50000000000000000.0,
                -25051699854744786049.0 / 100000000000000000.0,
                97321233326194213883.0 / 50000000000000000.0,
                -152251941051155183.0 / 50000000000000000.0,
                6132829744103521419.0 / 12500000000000000.0,
                156647589531270907.0 / 100000000000000000.0,
                -94098714497005586681.0 / 50000000000000000.0,
                7525922247248471753.0 / 100000000000000000.0,
                864335892450827669.0 / 25000000000000000.0,
                321147679440968961.0 / 100000000000000000.0,
                -46040804173841439.0 / 100000000000000000.0,
                -1741436679683621.0 / 20000000000000000.0,
                -184837953539575767.0 / 25000000000000000.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
            ],
            [
                3921722466502709.0 / 100000000000000000.0,
                343347475853550879.0 / 100000000000000000.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                249163204855817.0 / 100000000000000000.0,
                2301387878545931.0 / 100000000000000000.0,
                -322155956692977.0 / 100000000000000000.0,
                197688509889533.0 / 20000000000000000.0,
                54063199844480627.0 / 25000000000000000.0,
                -1626998645464574213.0 / 100000000000000000.0,
                -2570690042410491.0 / 20000000000000000.0,
                -898915042666504253.0 / 100000000000000000.0,
                -13943814529281.0 / 4000000000000000.0,
                63174477645335923.0 / 4000000000000000.0,
                -57440333091409507.0 / 100000000000000000.0,
                -3456020390213933.0 / 10000000000000000.0,
                -132448298041317.0 / 20000000000000000.0,
                -194447032310551.0 / 25000000000000000.0,
                -14243367696091.0 / 4000000000000000.0,
                1198206266124827.0 / 250000000000000.0,
                7686273243653429.0 / 50000000000000000.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
            ],
            [
                9090909090909091.0 / 25000000000000000.0,
                3230385208719854423.0 / 100000000000000000.0,
                0.0,
                0.0,
                0.0,
                0.0,
                -63597539253241.0 / 20000000000000000.0,
                10079971436327401.0 / 12500000000000000.0,
                975983126412389.0 / 10000000000000000.0,
                77857557815839891.0 / 100000000000000000.0,
                20489042383159943.0 / 100000000000000000.0,
                -39065394906867047.0 / 25000000000000000.0,
                0.0,
                817149459411552853.0 / 50000000000000000.0,
                -15454455529354362123.0 / 100000000000000000.0,
                156971088703334873.0 / 100000000000000000.0,
                327685545087248131.0 / 100000000000000000.0,
                -1258723112984133.0 / 25000000000000000.0,
                15332115185804166507.0 / 100000000000000000.0,
                44848011645482531.0 / 6250000000000000.0,
                -147018374337650241.0 / 50000000000000000.0,
                -6658459460768031.0 / 100000000000000000.0,
                -4623460549908437.0 / 100000000000000000.0,
                -1020993667928397.0 / 50000000000000000.0,
                -1067046212877471701.0 / 20000000000000000.0,
                -27109742943015731.0 / 20000000000000000.0,
                -9824767237577047.0 / 6250000000000000.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
            ],
            [
                35035051988507537.0 / 50000000000000000.0,
                -1664514674863415129.0 / 100000000000000000.0,
                0.0,
                0.0,
                0.0,
                0.0,
                592232780324503.0 / 100000000000000000.0,
                47032615996384111.0 / 100000000000000000.0,
                299688863848679.0 / 1000000000000000.0,
                -24765687759399491.0 / 100000000000000000.0,
                1386187872142971.0 / 12500000000000000.0,
                0.0,
                -9834380876924583.0 / 20000000000000000.0,
                -114743154427289497.0 / 10000000000000000.0,
                321037266630492109.0 / 4000000000000000.0,
                -7682646079600857.0 / 20000000000000000.0,
                728147667468107583.0 / 100000000000000000.0,
                -6634969230612419.0 / 50000000000000000.0,
                -8107998325257307267.0 / 100000000000000000.0,
                -781484330222629.0 / 625000000000000.0,
                259263594969543681.0 / 100000000000000000.0,
                -15072014917320227.0 / 50000000000000000.0,
                11069223039491617.0 / 50000000000000000.0,
                8275772747718929.0 / 100000000000000000.0,
                379921324081223041.0 / 20000000000000000.0,
                26923194640963969.0 / 100000000000000000.0,
                162674827447066537.0 / 100000000000000000.0,
                9834380876924583.0 / 20000000000000000.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
            ],
            [
                14015279904218877.0 / 100000000000000000.0,
                8384798124090527.0 / 100000000000000000.0,
                0.0,
                0.0,
                0.0,
                0.0,
                -589746835504869.0 / 50000000000000000.0,
                -4945980411376253.0 / 20000000000000000.0,
                978080858367729.0 / 10000000000000000.0,
                21759068924342063.0 / 100000000000000000.0,
                0.0,
                6879280338166261.0 / 50000000000000000.0,
                4398702297150467.0 / 100000000000000000.0,
                0.0,
                -25685040688409667.0 / 50000000000000000.0,
                82635569115131551.0 / 100000000000000000.0,
                1285090698599059163.0 / 50000000000000000.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                -1285090698599059163.0 / 50000000000000000.0,
                -82635569115131551.0 / 100000000000000000.0,
                25685040688409667.0 / 50000000000000000.0,
                -4398702297150467.0 / 100000000000000000.0,
                -6879280338166261.0 / 50000000000000000.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
            ],
            [
                7426709605345459.0 / 25000000000000000.0,
                12438052665409441.0 / 100000000000000000.0,
                0.0,
                0.0,
                0.0,
                2261202821975843.0 / 10000000000000000.0,
                1378858876180809.0 / 100000000000000000.0,
                -1680525334991711.0 / 25000000000000000.0,
                0.0,
                0.0,
                -17124779501708567.0 / 20000000000000000.0,
                -196337522866858909.0 / 100000000000000000.0,
                -1161664113620597.0 / 5000000000000000.0,
                0.0,
                430660719086453349.0 / 100000000000000000.0,
                -292722963249465483.0 / 100000000000000000.0,
                -1646263332795717889.0 / 20000000000000000.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                1646263332795717889.0 / 20000000000000000.0,
                292722963249465483.0 / 100000000000000000.0,
                -430660719086453349.0 / 100000000000000000.0,
                1161664113620597.0 / 5000000000000000.0,
                196337522866858909.0 / 100000000000000000.0,
                17124779501708567.0 / 20000000000000000.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
            ],
            [
                16749674481819323.0 / 25000000000000000.0,
                5174228081833989.0 / 50000000000000000.0,
                0.0,
                0.0,
                6103444365320361.0 / 50000000000000000.0,
                24128724516562331.0 / 50000000000000000.0,
                -381409600015607.0 / 10000000000000000.0,
                0.0,
                -6881244066385029.0 / 12500000000000000.0,
                0.0,
                -71191581158518923.0 / 100000000000000000.0,
                -29206480283577567.0 / 50000000000000000.0,
                0.0,
                0.0,
                52761577031466233.0 / 25000000000000000.0,
                -8374947367395721.0 / 100000000000000000.0,
                255010749536160457.0 / 50000000000000000.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                -255010749536160457.0 / 50000000000000000.0,
                8374947367395721.0 / 100000000000000000.0,
                -52761577031466233.0 / 25000000000000000.0,
                0.0,
                29206480283577567.0 / 50000000000000000.0,
                71191581158518923.0 / 100000000000000000.0,
                6881244066385029.0 / 12500000000000000.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
            ],
            [
                33333333333333333.0 / 100000000000000000.0,
                19333333333333333.0 / 100000000000000000.0,
                0.0,
                11.0 / 50.0,
                -2.0 / 25.0,
                0.0,
                0.0,
                1099934255807247.0 / 10000000000000000.0,
                -3178713100953377.0 / 12500000000000000.0,
                0.0,
                3462283108466777.0 / 4000000000000000.0,
                332416449114093083.0 / 100000000000000000.0,
                0.0,
                0.0,
                -1201022233159779339.0 / 100000000000000000.0,
                11915036656062331.0 / 25000000000000000.0,
                -580486022442072781.0 / 20000000000000000.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                580486022442072781.0 / 20000000000000000.0,
                -11915036656062331.0 / 25000000000000000.0,
                1201022233159779339.0 / 100000000000000000.0,
                0.0,
                -332416449114093083.0 / 100000000000000000.0,
                -3462283108466777.0 / 4000000000000000.0,
                3178713100953377.0 / 12500000000000000.0,
                -1099934255807247.0 / 10000000000000000.0,
                0.0,
                0.0,
                0.0,
                0.0,
            ],
            [
                13888888888888889.0 / 25000000000000000.0,
                -83333333333333333.0 / 100000000000000000.0,
                138888888888888889.0 / 100000000000000000.0,
                0.0,
                0.0,
                -3.0 / 4.0,
                0.0,
                -4925295437180263.0 / 10000000000000000.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                4925295437180263.0 / 10000000000000000.0,
                3.0 / 4.0,
                0.0,
                0.0,
                0.0,
            ],
            [
                11111111111111111.0 / 100000000000000000.0,
                11111111111111111.0 / 100000000000000000.0,
                0.0,
                -11111111111111111.0 / 50000000000000000.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                11111111111111111.0 / 50000000000000000.0,
                0.0,
                0.0,
            ],
            [
                1.0 / 1.0,
                7145878509724289.0 / 25000000000000000.0,
                29166666666666667.0 / 100000000000000000.0,
                7.0 / 32.0,
                0.0,
                21.0 / 128.0,
                0.0,
                10909717747277833.0 / 50000000000000000.0,
                18039289847869777.0 / 100000000000000000.0,
                0.0,
                10285691970242251.0 / 50000000000000000.0,
                94810856086629.0 / 390625000000000.0,
                24646578081362931.0 / 100000000000000000.0,
                -13799677631635633.0 / 4000000000000000.0,
                2860944527000451.0 / 12500000000000000.0,
                14164529985107571.0 / 50000000000000000.0,
                321085125837766641.0 / 100000000000000000.0,
                -2235387773648457.0 / 10000000000000000.0,
                -70712115720441907.0 / 100000000000000000.0,
                8028083628757177.0 / 2500000000000000.0,
                70477174154834883.0 / 50000000000000000.0,
                -15136205344374261.0 / 100000000000000000.0,
                9308764363175357.0 / 25000000000000000.0,
                12648937320318067.0 / 50000000000000000.0,
                -321085125837766641.0 / 100000000000000000.0,
                -14164529985107571.0 / 50000000000000000.0,
                -2860944527000451.0 / 12500000000000000.0,
                -24646578081362931.0 / 100000000000000000.0,
                -94810856086629.0 / 390625000000000.0,
                -10285691970242251.0 / 50000000000000000.0,
                -18039289847869777.0 / 100000000000000000.0,
                -10909717747277833.0 / 50000000000000000.0,
                -21.0 / 128.0,
                -7.0 / 32.0,
                -29166666666666667.0 / 100000000000000000.0,
                0.0,
            ],
        ],
        dtype=numpy.float64,
    )

    C = tableau[:, 0]
    A = tableau[:, 1:]
    B = numpy.array(
        [
            892857142857143.0 / 50000000000000000.0,
            3.0 / 512.0,
            3.0 / 256.0,
            0.0,
            9.0 / 512.0,
            0.0,
            3.0 / 128.0,
            15.0 / 512.0,
            0.0,
            9.0 / 256.0,
            21.0 / 512.0,
            3.0 / 64.0,
            0.0,
            27.0 / 512.0,
            15.0 / 256.0,
            33.0 / 512.0,
            0.0,
            5267605678587651.0 / 50000000000000000.0,
            8528067312087609.0 / 50000000000000000.0,
            10311469866467597.0 / 50000000000000000.0,
            10311469866467597.0 / 50000000000000000.0,
            8528067312087609.0 / 50000000000000000.0,
            5267605678587651.0 / 50000000000000000.0,
            -33.0 / 512.0,
            -15.0 / 256.0,
            -27.0 / 512.0,
            -3.0 / 64.0,
            -21.0 / 512.0,
            -9.0 / 256.0,
            -15.0 / 512.0,
            -3.0 / 128.0,
            -9.0 / 512.0,
            -3.0 / 256.0,
            -3.0 / 512.0,
            892857142857143.0 / 50000000000000000.0,
        ]
    )
    # B_hat
    E = numpy.array(
        [
            892857142857143.0 / 50000000000000000.0,
            242968749999999999.0 / 50000000000000000000.0,
            3.0 / 256.0,
            0.0,
            9.0 / 512.0,
            0.0,
            3.0 / 128.0,
            15.0 / 512.0,
            0.0,
            9.0 / 256.0,
            21.0 / 512.0,
            3.0 / 64.0,
            0.0,
            27.0 / 512.0,
            15.0 / 256.0,
            33.0 / 512.0,
            0.0,
            5267605678587651.0 / 50000000000000000.0,
            8528067312087609.0 / 50000000000000000.0,
            10311469866467597.0 / 50000000000000000.0,
            10311469866467597.0 / 50000000000000000.0,
            8528067312087609.0 / 50000000000000000.0,
            5267605678587651.0 / 50000000000000000.0,
            -33.0 / 512.0,
            -15.0 / 256.0,
            -27.0 / 512.0,
            -3.0 / 64.0,
            -21.0 / 512.0,
            -9.0 / 256.0,
            -15.0 / 512.0,
            -3.0 / 128.0,
            -9.0 / 512.0,
            -3.0 / 256.0,
            -242968749999999999.0 / 50000000000000000000.0,
            892857142857143.0 / 50000000000000000.0,
            0.0,
        ]
    )
    E[:-1] -= B


class DP87(RungeKutta):
    # Dormand Prince 8(7) scheme
    order = 8
    error_estimator_order = 7
    n_stages = 13

    tableau = numpy.array(
        [
            [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0],
            [
                1 / 18,
                1 / 18,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
            ],
            [
                1 / 12,
                1 / 48,
                1 / 16,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
            ],
            [
                1 / 8,
                1 / 32,
                0.0,
                3 / 32,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
            ],
            [
                5 / 16,
                5 / 16,
                0.0,
                -75 / 64,
                75 / 64,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
            ],
            [
                3 / 8,
                3 / 80,
                0.0,
                0.0,
                3 / 16,
                3 / 20,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
            ],
            [
                59 / 400,
                29443841 / 614563906,
                0.0,
                0.0,
                77736538 / 692538347,
                -28693883 / 1125000000,
                23124283 / 1800000000,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
            ],
            [
                93 / 200,
                16016141 / 946692911,
                0.0,
                0.0,
                61564180 / 158732637,
                22789713 / 633445777,
                545815736 / 2771057229,
                -180193667 / 1043307555,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
            ],
            [
                5490023248 / 9719169821,
                39632708 / 573591083,
                0.0,
                0.0,
                -433636366 / 683701615,
                -421739975 / 2616292301,
                100302831 / 723423059,
                790204164 / 839813087,
                800635310 / 3783071287,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
            ],
            [
                13 / 20,
                246121993 / 1340847787,
                0.0,
                0.0,
                -37695042795 / 15268766246,
                -309121744 / 1061227803,
                -12992083 / 490766935,
                6005943493 / 2108947869,
                393006217 / 1396673457,
                123872331 / 1001029789,
                0.0,
                0.0,
                0.0,
                0.0,
            ],
            [
                1201146811 / 1299019798,
                -1028468189 / 846180014,
                0.0,
                0.0,
                8478235783 / 508512852,
                1311729495 / 1432422823,
                -10304129995 / 1701304382,
                -48777925059 / 3047939560,
                15336726248 / 1032824649,
                -45442868181 / 3398467696,
                3065993473 / 597172653,
                0.0,
                0.0,
                0.0,
            ],
            [
                1,
                185892177 / 718116043,
                0.0,
                0.0,
                -3185094517 / 667107341,
                -477755414 / 1098053517,
                -703635378 / 230739211,
                5731566787 / 1027545527,
                5232866602 / 850066563,
                -4093664535 / 808688257,
                3962137247 / 1805957418,
                65686358 / 487910083,
                0.0,
                0.0,
            ],
            [
                1,
                403863854 / 491063109,
                0.0,
                0.0,
                -5068492393 / 434740067,
                -411421997 / 543043805,
                652783627 / 914296604,
                11173962825 / 925320556,
                -13158990841 / 6184727034,
                3936647629 / 1978049680,
                -160528059 / 685178525,
                248638103 / 1413531060,
                0.0,
                0.0,
            ],
        ],
        dtype=numpy.float64,
    )
    C = tableau[:, 0]
    A = tableau[:, 1:]
    B = numpy.array(
        [
            13451932 / 455176623,
            0.0,
            0.0,
            0.0,
            0.0,
            -808719846 / 976000145,
            1757004468 / 5645159321,
            656045339 / 265891186,
            -3867574721 / 1518517206,
            465885868 / 322736535,
            53011238 / 667516719,
            2 / 45,
            0.0,
        ]
    )
    E = numpy.array(
        [
            14005451 / 335480064,
            0.0,
            0.0,
            0.0,
            0.0,
            -59238493 / 1068277825,
            181606767 / 758867731,
            561292985 / 797845732,
            -1041891430 / 1371343529,
            760417239 / 1151165299,
            118820643 / 751138087,
            -528747749 / 2220607170,
            1 / 4,
            0.0,
        ]
    )
    E[:-1] -= B


class F10_8(RungeKutta):
    # Feagin 10(8)
    order = 10
    error_estimator_order = 8
    n_stages = 17

    tableau = numpy.array(
        [
            [
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
            ],
            [
                1.0 / 10.0,
                1.0 / 10.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
            ],
            [
                53935784080298178753.0 / 100000000000000000000.0,
                -22879414034382286013.0 / 25000000000000000000.0,
                29090688043565464561.0 / 20000000000000000000.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
            ],
            [
                8090367612044726813.0 / 10000000000000000000.0,
                2528239878763977129.0 / 12500000000000000000.0,
                0.0,
                60677757090335451097.0 / 100000000000000000000.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
            ],
            [
                3090367612044726813.0 / 10000000000000000000.0,
                3680494294172871503.0 / 20000000000000000000.0,
                0.0,
                19796683122719236907.0 / 100000000000000000000.0,
                -1823869618284081573.0 / 25000000000000000000.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
            ],
            [
                3924296760879181073.0 / 4000000000000000000.0,
                8790073402066813373.0 / 100000000000000000000.0,
                0.0,
                0.0,
                10261492563006516133.0 / 25000000000000000000.0,
                1206784384197166223.0 / 2500000000000000000.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
            ],
            [
                83333333333333333333.0 / 100000000000000000000.0,
                4298502524512301511.0 / 50000000000000000000.0,
                0.0,
                0.0,
                6617719260814443679.0 / 20000000000000000000.0,
                12241573932736254821.0 / 25000000000000000000.0,
                -914820468838563421.0 / 12500000000000000000.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
            ],
            [
                35401736585680237633.0 / 100000000000000000000.0,
                6046522456266686033.0 / 50000000000000000000.0,
                0.0,
                0.0,
                0.0,
                26012467575829562281.0 / 100000000000000000000.0,
                1627013107745456651.0 / 50000000000000000000.0,
                -186181316192925313.0 / 3125000000000000000.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
            ],
            [
                88252766196473234643.0 / 100000000000000000000.0,
                11085437958039148351.0 / 100000000000000000000.0,
                0.0,
                0.0,
                0.0,
                0.0,
                -1514403720637513969.0 / 25000000000000000000.0,
                3217637056017783901.0 / 10000000000000000000.0,
                25524286280403151579.0 / 50000000000000000000.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
            ],
            [
                2008174244501007963.0 / 3125000000000000000.0,
                11205441475287900483.0 / 100000000000000000000.0,
                0.0,
                0.0,
                0.0,
                0.0,
                -14494277590286591567.0 / 100000000000000000000.0,
                -33326971909625670659.0 / 100000000000000000000.0,
                9985384591137601227.0 / 20000000000000000000.0,
                6368807611621076303.0 / 12500000000000000000.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
            ],
            [
                1116825755498992037.0 / 3125000000000000000.0,
                5698839198209299307.0 / 50000000000000000000.0,
                0.0,
                0.0,
                0.0,
                0.0,
                -3844066821016784693.0 / 50000000000000000000.0,
                23952736032439064911.0 / 100000000000000000000.0,
                7955493247361892781.0 / 20000000000000000000.0,
                268897392184018639.0 / 25000000000000000000.0,
                -6555382483280377483.0 / 20000000000000000000.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
            ],
            [
                11747233803526765357.0 / 100000000000000000000.0,
                498946580175122529.0 / 6250000000000000000.0,
                0.0,
                0.0,
                0.0,
                0.0,
                -1040659373601206153.0 / 20000000000000000000.0,
                -5769541461685488817.0 / 100000000000000000000.0,
                9739095785605208249.0 / 50000000000000000000.0,
                14538492318832506973.0 / 100000000000000000000.0,
                -122334798492448559.0 / 1562500000000000000.0,
                -5725164968054945609.0 / 50000000000000000000.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
            ],
            [
                83333333333333333333.0 / 100000000000000000000.0,
                24627890254121432003.0 / 25000000000000000000.0,
                0.0,
                0.0,
                6617719260814443679.0 / 20000000000000000000.0,
                12241573932736254821.0 / 25000000000000000000.0,
                -68948243287421783791.0 / 50000000000000000000.0,
                -86116419502763566667.0 / 100000000000000000000.0,
                578428813637537220023.0 / 100000000000000000000.0,
                32880776198510356689.0 / 10000000000000000000.0,
                -238633905093136384013.0 / 100000000000000000000.0,
                -65095868496728783731.0 / 20000000000000000000.0,
                -108171770843211491177.0 / 50000000000000000000.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
            ],
            [
                3090367612044726813.0 / 10000000000000000000.0,
                17901605915432657821.0 / 20000000000000000000.0,
                0.0,
                19796683122719236907.0 / 100000000000000000000.0,
                -1823869618284081573.0 / 25000000000000000000.0,
                0.0,
                -42561811983100380987.0 / 50000000000000000000.0,
                9958002807963332543.0 / 25000000000000000000.0,
                363937263181035606029.0 / 100000000000000000000.0,
                30964575407966064473.0 / 20000000000000000000.0,
                -106110857352026858013.0 / 50000000000000000000.0,
                -158350398545326172713.0 / 100000000000000000000.0,
                -85780804142968132461.0 / 50000000000000000000.0,
                -2440364057501274521.0 / 100000000000000000000.0,
                0.0,
                0.0,
                0.0,
                0.0,
            ],
            [
                53935784080298178753.0 / 100000000000000000000.0,
                -22879414034382286013.0 / 25000000000000000000.0,
                29090688043565464561.0 / 20000000000000000000.0,
                0.0,
                0.0,
                -38866682182248411677.0 / 50000000000000000000.0,
                0.0,
                -1138619577693970087.0 / 12500000000000000000.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                1138619577693970087.0 / 12500000000000000000.0,
                38866682182248411677.0 / 50000000000000000000.0,
                0.0,
                0.0,
                0.0,
            ],
            [
                1.0 / 10.0,
                1.0 / 10.0,
                0.0,
                -15717866579977116337.0 / 100000000000000000000.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                15717866579977116337.0 / 100000000000000000000.0,
                0.0,
                0.0,
            ],
            [
                1.0 / 1.0,
                18178130070009528389.0 / 100000000000000000000.0,
                27.0 / 40.0,
                17137907992359491997.0 / 50000000000000000000.0,
                0.0,
                25911121454832274451.0 / 100000000000000000000.0,
                -7165579334359041781.0 / 20000000000000000000.0,
                -20918979188176661219.0 / 20000000000000000000.0,
                93032784541562698329.0 / 100000000000000000000.0,
                88975479715854051223.0 / 50000000000000000000.0,
                1.0 / 10.0,
                -28254756953904408161.0 / 100000000000000000000.0,
                -15932735011997254917.0 / 100000000000000000000.0,
                -7275794732350075543.0 / 50000000000000000000.0,
                -25911121454832274451.0 / 100000000000000000000.0,
                -17137907992359491997.0 / 50000000000000000000.0,
                -27.0 / 40.0,
                0.0,
            ],
        ],
        dtype=numpy.float64,
    )

    final_state = numpy.array(
        [
            [
                0.0,
                3333333333333333333.0 / 100000000000000000000.0,
                1.0 / 40.0,
                3333333333333333333.0 / 100000000000000000000.0,
                0.0,
                1.0 / 20.0,
                0.0,
                1.0 / 25.0,
                0.0,
                2365468476861543627.0 / 12500000000000000000.0,
                27742918851774317651.0 / 100000000000000000000.0,
                27742918851774317651.0 / 100000000000000000000.0,
                2365468476861543627.0 / 12500000000000000000.0,
                -1.0 / 25.0,
                -1.0 / 20.0,
                -3333333333333333333.0 / 100000000000000000000.0,
                -1.0 / 40.0,
                3333333333333333333.0 / 100000000000000000000.0,
            ],
            [
                0.0,
                3333333333333333333.0 / 100000000000000000000.0,
                1.0 / 36.0,
                3333333333333333333.0 / 100000000000000000000.0,
                0.0,
                1.0 / 20.0,
                0.0,
                1.0 / 25.0,
                0.0,
                2365468476861543627.0 / 12500000000000000000.0,
                27742918851774317651.0 / 100000000000000000000.0,
                27742918851774317651.0 / 100000000000000000000.0,
                2365468476861543627.0 / 12500000000000000000.0,
                -1.0 / 25.0,
                -1.0 / 20.0,
                -3333333333333333333.0 / 100000000000000000000.0,
                -1.0 / 36.0,
                3333333333333333333.0 / 100000000000000000000.0,
            ],
        ],
        dtype=numpy.float64,
    )
    C = tableau[:, 0]
    A = tableau[:, 1:]
    B = numpy.array(
        [
            3333333333333333333.0 / 100000000000000000000.0,
            1.0 / 40.0,
            3333333333333333333.0 / 100000000000000000000.0,
            0.0,
            1.0 / 20.0,
            0.0,
            1.0 / 25.0,
            0.0,
            2365468476861543627.0 / 12500000000000000000.0,
            27742918851774317651.0 / 100000000000000000000.0,
            27742918851774317651.0 / 100000000000000000000.0,
            2365468476861543627.0 / 12500000000000000000.0,
            -1.0 / 25.0,
            -1.0 / 20.0,
            -3333333333333333333.0 / 100000000000000000000.0,
            -1.0 / 40.0,
            3333333333333333333.0 / 100000000000000000000.0,
        ]
    )
    E = numpy.array(
        [
            3333333333333333333.0 / 100000000000000000000.0,
            1.0 / 36.0,
            3333333333333333333.0 / 100000000000000000000.0,
            0.0,
            1.0 / 20.0,
            0.0,
            1.0 / 25.0,
            0.0,
            2365468476861543627.0 / 12500000000000000000.0,
            27742918851774317651.0 / 100000000000000000000.0,
            27742918851774317651.0 / 100000000000000000000.0,
            2365468476861543627.0 / 12500000000000000000.0,
            -1.0 / 25.0,
            -1.0 / 20.0,
            -3333333333333333333.0 / 100000000000000000000.0,
            -1.0 / 36.0,
            3333333333333333333.0 / 100000000000000000000.0,
            0.0,
        ]
    )
    E[:-1] -= B


METHODS = {
    "BS3(2)": BS32,
    "DP5(4)": DP54,
    "M4(3)": M43,
    "KC3(2)": KC32,
    "EXLRK3(2)": ExLRK32,
    "EXLRK4(3)": ExLRK43,
    "F14(12)": F14_12,
    "DP8(7)": DP87,
    "F10(8)": F10_8,
}
